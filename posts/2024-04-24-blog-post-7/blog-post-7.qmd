---
title: "Blog Post 7"
description:  |
  Blog Post 7 of Team 2
author: ""
date: "2024-04-24"
date-modified: "2024-04-24"
draft: FALSE
---
```{r}
library(dplyr)
library(readr)  # For read_csv()

# Load the data
data <- read_csv("path/to/your/data.csv")

# Calculating total deaths and racial composition percentages
death_counts <- data %>%
  group_by(State, City) %>%
  summarize(
    TotalDeaths = n(),  # Count of deaths
    .groups = 'drop'  # Drop grouping structure after summarizing
  )

racial_composition <- data %>%
  group_by(State, City, Race) %>%
  summarize(
    Count = n(),
    .groups = 'drop'
  ) %>%
  group_by(State, City) %>%
  mutate(
    Percentage = Count / sum(Count) * 100
  )

# Calculate discrepancies (Example: comparing racial percentages with total deaths, though this might need further clarification or adjustment)
discrepancies <- racial_composition %>%
  left_join(death_counts, by = c("State", "City")) %>%
  mutate(
    Discrepancy = abs(Percentage - (TotalDeaths / sum(TotalDeaths) * 100))
  ) %>%
  arrange(desc(Discrepancy))

# Identify and display locations with the highest discrepancies
top_discrepancies <- discrepancies %>%
  top_n(1, Discrepancy)

print(top_discrepancies)

```
